package com.pace.riscovery.test.ui;

import java.io.File;
import java.io.IOException;

import org.easymock.EasyMock;
import org.junit.Assert;
import org.junit.Test;

import com.pace.riscovery.Logic.ApplicationLogic;
import com.pace.riscovery.Logic.Logic;
import com.pace.riscovery.views.View;



public class OnOpenTest {

	@Test
	public void testExistentFile() throws IOException {
		Logic logic = new ApplicationLogic();
		View view = EasyMock.createNiceMock(View.class);
		
		File returnFile = File.createTempFile("SomeFile", "xlsx");
		returnFile.deleteOnExit();
		Assert.assertTrue(returnFile.isFile());
		
		EasyMock.expect(view.showOpenFileChooser(null)).andReturn(returnFile);
		EasyMock.expect(view.showOpenFileChooser(returnFile)).andReturn(returnFile);
		EasyMock.replay(view);
		
		logic.setView(view);
		
		
		//This mimics the user clicking the open menu
		logic.onOpen();
		logic.onOpen();
		
		EasyMock.verify(view);
	}

}
